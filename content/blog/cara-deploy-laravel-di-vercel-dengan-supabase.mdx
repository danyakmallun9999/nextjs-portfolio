---
title: 'Cara Deploy Laravel 12 di Vercel + Supabase (Gratis)'
description: 'Cara deploy Laravel 12 ke Vercel pakai database Supabase GRATISSS.'
publishedAt: '2025-12-20'
coverImage: '/posts/deploy-laravel.png'
category: 'Development'
tags: ['laravel', 'vercel', 'supabase', 'deploy']
---

# Cara Deploy Laravel di Vercel + Supabase (GRATIS)

Halo, _Devs_!

Pernah merasa pusing memikirkan biaya hosting Laravel untuk proyek hobi atau portofolio? _Shared hosting_ sering kali lambat, sementara VPS memerlukan konfigurasi yang cukup rumit.

Kali ini saya akan berbagi "resep dapur" deployment yang sering saya gunakan: **Laravel di Vercel** dengan database **Supabase**. Kombinasi ini bukan hanya gratis, tetapi juga sangat kencang karena berbasis _serverless architecture_.

Namun, karena sifatnya yang _stateless_, ada beberapa trik khusus agar Laravel berjalan mulus di Vercel. Mari kita bedah!

## Persiapan Amunisi

Sebelum mulai, pastikan Anda sudah memiliki hal-hal berikut:

1. **Akun GitHub**: Untuk menyimpan repositori (wajib).
2. **Akun Vercel**: Disarankan login menggunakan GitHub.
3. **Akun Supabase**: Sebagai database PostgreSQL gratis dengan fitur melimpah.
4. **Kopi â˜•**: Opsional.

## Langkah 1: Setup Database Supabase

Karena Vercel berjalan di lingkungan _serverless_, alamat IP server akan berubah-ubah. Untuk menghindari masalah koneksi, kita wajib menggunakan **Connection Pooler**.

1. Buat proyek baru di [Supabase](https://supabase.com).
2. Navigasi ke menu **Settings > Database**.
3. Cari bagian **Connection Pooler**.
4. Aktifkan toggle **"Use connection pooler"** (Wajib!).
5. Pastikan **Pool Mode** disetel ke `Session`.
6. Catat kredensialnya (Gunakan **Port 6543**).

> **Catatan Penting:** Jangan gunakan _Direct Connection_ (Port 5432). Banyak platform _serverless_ mengalami masalah resolusi IPv6. Gunakan selalu **Port 6543**.

## Langkah 2: Konfigurasi Laravel untuk Vercel

Agar Laravel dapat berjalan di infrastruktur Vercel, kita perlu menambahkan beberapa file konfigurasi khusus.

### 1. Membuat `vercel.json`

Buat file ini di _root directory_ proyek Anda. File ini bertindak sebagai instruksi bagi Vercel untuk menjalankan PHP.

```json
{
  "version": 2,
  "outputDirectory": "public",
  "framework": null,
  "functions": {
    "api/index.php": { "runtime": "vercel-php@0.7.4" }
  },
  "routes": [
    { "src": "/build/(.*)", "dest": "/public/build/$1" },
    { "src": "/(images|assets|css|js)/(.*)", "dest": "/public/$1/$2" },
    { "src": "/(.*)", "primary": true, "dest": "/api/index.php" }
  ],
  "env": {
    "APP_ENV": "production",
    "APP_DEBUG": "false",
    "APP_CONFIG_CACHE": "/tmp/config.php",
    "CACHE_STORE": "array",
    "SESSION_DRIVER": "cookie"
  }
}
```

### 2. Membuat Entry Point `api/index.php`

Vercel membutuhkan _file handler_ di dalam folder `api`. Buat folder tersebut dan isi dengan file `index.php`:

```php
<?php
// Meneruskan request ke file index utama Laravel
require __DIR__ . '/../public/index.php';

```

### 3. Konfigurasi `.vercelignore`

Agar proses deploy lebih cepat, abaikan file yang tidak diperlukan:

```text
.env
/node_modules
/tests
/storage/logs
README.md

```

### 4. Penyesuaian `.gitignore`

Secara bawaan, Laravel mengabaikan folder `public/build`. Namun, jika Anda melakukan kompilasi aset (Vite) di lokal, folder ini **harus** ikut diunggah. Hapus atau beri komentar pada baris berikut di `.gitignore`:

```gitignore
# /public/build  <-- Matikan ignore agar aset ikut ter-upload

```

### 5. Memaksa Protokol HTTPS

Terkadang terjadi _mixed content error_ di mana Vercel menggunakan HTTPS tetapi Laravel menganggapnya HTTP. Tambahkan kode berikut di `app/Providers/AppServiceProvider.php`:

```php
public function boot(): void
{
    if ($this->app->environment('production')) {
        \Illuminate\Support\Facades\URL::forceScheme('https');
    }
}

```

## Langkah 3: Build & Deploy

Sekarang saatnya meluncurkan aplikasi Anda ke internet.

1. **Build Aset**: Jalankan `npm run build` di terminal lokal Anda.
2. **Push ke GitHub**: Lakukan _commit_ dan _push_ seluruh perubahan.
3. **Import di Vercel**: Buka _dashboard_ Vercel, pilih **New Project**, dan arahkan ke repositori Anda.
4. **Environment Variables**: Masukkan variabel berikut di bagian **Environment Variables** sebelum klik _Deploy_:

| Key             | Keterangan                                         |
| --------------- | -------------------------------------------------- |
| `APP_KEY`       | Salin dari `.env` lokal Anda (format `base64:...`) |
| `DB_CONNECTION` | `pgsql`                                            |
| `DB_HOST`       | Host dari Supabase (_Connection Pooler_)           |
| `DB_PORT`       | `6543`                                             |
| `DB_DATABASE`   | `postgres`                                         |
| `DB_USERNAME`   | Username database Anda                             |
| `DB_PASSWORD`   | Password database Anda                             |

> **Pro Tip:** Jika muncul error `prepared statement does not exist`, tambahkan konfigurasi ini di `config/database.php` pada bagian `pgsql`:
>
> ```php
> 'options' => [
>     PDO::ATTR_EMULATE_PREPARES => true,
> ],
>
> ```

## Langkah 4: Migrasi Database (Cara Praktis)

Karena Vercel tidak menyediakan akses terminal SSH untuk menjalankan `php artisan migrate`, cara termudah adalah melakukannya dari komputer lokal Anda:

1. Buka file `.env` di lokal secara sementara.
2. Ganti kredensial database lokal dengan kredensial Supabase.
3. Jalankan perintah `php artisan migrate` dari terminal laptop Anda.
4. Setelah selesai, kembalikan isi `.env` lokal ke pengaturan semula.

## Langkah 5: Penanganan File Upload (Supabase Storage)

Penyimpanan di Vercel bersifat **ephemeral** (sementara). File yang diunggah ke folder `storage` akan hilang secara otomatis. Solusinya, kita gunakan **Supabase Storage** sebagai penggantinya.

### 1. Setup di Supabase

- Buka menu **Storage**, buat _bucket_ baru (misalnya: `uploads`).
- Pastikan statusnya adalah **Public**.

### 2. Install Driver S3

Laravel dapat berkomunikasi dengan Supabase Storage menggunakan protokol S3. Jalankan:

```bash
composer require league/flysystem-aws-s3-v3 "^3.0"

```

### 3. Konfigurasi Env untuk Storage

Tambahkan variabel berikut di Vercel Dashboard agar Laravel tahu di mana harus menyimpan file:

- `FILESYSTEM_DISK` = `s3`
- `AWS_ACCESS_KEY_ID` = (Cek di Project Settings > API)
- `AWS_SECRET_ACCESS_KEY` = (Cek di Project Settings > API)
- `AWS_DEFAULT_REGION` = `ap-southeast-1` (atau region Supabase Anda)
- `AWS_BUCKET` = `uploads`
- `AWS_URL` = (URL publik bucket Anda)
- `AWS_ENDPOINT` = (Endpoint S3 dari Supabase)

## Troubleshooting & Tips

- **CSS/JS Tidak Muncul?** Pastikan Anda sudah menjalankan `npm run build` dan folder `public/build` tidak ter-ignore oleh Git.
- **Error 500?** Periksa **Function Logs** di dashboard Vercel untuk melihat pesan error PHP yang lebih detail.
- **Session Bermasalah?** Pastikan `SESSION_DRIVER` diatur ke `cookie` karena serverless tidak mendukung session berbasis file secara stabil.

## Penutup

Sekarang aplikasi Laravel 12 Anda sudah mengudara secara gratis dengan performa yang mumpuni. Memanfaatkan infrastruktur _serverless_ memang butuh sedikit penyesuaian, tapi hasilnya sangat sepadan.
